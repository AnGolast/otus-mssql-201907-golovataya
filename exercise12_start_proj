create database books_shop;
--бд книжный магазин. содержит информацию о покупателях, книгах и заказах клиентов
--use books_shop;
--таблица "заказы" 
create table dbo.orders (id_order int not null primary key,
						 date_order date not null,
						 summ_order decimal not null,
						 id_delivery int not null,
						 date_delivery date not null,
						 id_customer int not null ,
						 employee nvarchar(100) not null);
--таблица "позиции заказа"						
create table dbo.order_details (id_order_delails int not null primary key,
								id_order int not null,
								id_product int not null,
								quantity int not null);

--таблица "клиенты" 
create table dbo.customers (id_customer int not null primary key,
						   firstname nvarchar(50) not null,
						   surname nvarchar(50) null,
						   email nvarchar(150) not null,
						   phone_number nvarchar(15) not null,
						   birthday date null
							);
--таблица "продукт" 
create table dbo.products (id_product int not null primary key,
						  id_author int not null,
						  name_product nvarchar(100) not null,
						  publishing nvarchar(50) null,
						  year_publish nvarchar(4) null,
						  pages int null,
						  price decimal not null,
						  id_category int not null,
						  id_sale int not null);
--таблица "автор"							
create table dbo.authors (id_author int not null primary key,
							name nvarchar(100) not null);
--таблица "склад"
create table dbo.warehouses (id_position int not null primary key,
							id_product int not null,
							quantity int not null,
							date_change date not null);
--таблица категории, содержит инфомарцию о категории и жанре "продукта"
create table dbo.categories (id_category int not null primary key,
							category nvarchar(20) null,
							genre nvarchar(20) null);
--таблица акции\скидки: наимеование акции срок действия и наличие скидки
create table dbo.sales (id_sale int not null primary key,
						name_sale nvarchar(20) not null,
						sale int null,
						start_date date null,
						end_date date null);
--таблица доставка: вид доставки и стоимость
create table dbo.delivery_types (id_delivery int not null primary key,
							type nvarchar(10) not null,
							price decimal not null);

alter table dbo.orders
add foreign key (id_customer) references dbo.customers(id_customer);

alter table dbo.orders
add foreign key (id_delivery) references dbo.delivery_types(id_delivery);

alter table dbo.order_details
add foreign key (id_product) references dbo.products(id_product);

alter table dbo.order_details
add foreign key (id_order) references dbo.orders(id_order);

alter table dbo.products
add foreign key (id_sale) references dbo.sales(id_sale);

alter table dbo.products
add foreign key (id_category) references dbo.category(id_category);

alter table dbo.products
add foreign key (id_author) references dbo.authors(id_author);
